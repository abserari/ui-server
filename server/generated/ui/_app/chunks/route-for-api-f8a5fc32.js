var O=Object.defineProperty;var y=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var E=(o,n,c)=>n in o?O(o,n,{enumerable:!0,configurable:!0,writable:!0,value:c}):o[n]=c,k=(o,n)=>{for(var c in n||(n={}))B.call(n,c)&&E(o,c,n[c]);if(y)for(var c of y(n))L.call(n,c)&&E(o,c,n[c]);return o};import{d as v,e as w,t as N}from"./route-for-0fcfcb54.js";import{E as S}from"./index-a913e400.js";import{w as _}from"./index-de429506.js";import{n as b}from"./notifications-ed5cd8a8.js";import{i as $}from"./is-network-error-ac7c8caf.js";import{i as z}from"./is-function-b969a126.js";import{g as W}from"./get-api-origin-f0c2b6b0.js";const H=_(null),K=(o,n=b,c=H,i=w)=>{if(X(o)&&i){window.location.assign(v());return}if(D(o)&&i){window.location.assign(v());return}if($(o))throw n.add("error",`${o.statusCode} ${o.statusText}`),c.set(o),o;typeof o=="string"&&n.add("error",o),o instanceof Error&&n.add("error",o.message)},X=o=>$(o)?o.statusCode===401:!1,D=o=>$(o)?o.statusCode===403:!1,un=o=>(o==null?void 0:o.message)!==void 0&&typeof(o==null?void 0:o.message)=="string",G=async(o,n={},c=10)=>{var T;const{params:i={},request:d=fetch,token:s,shouldRetry:t=!1,notifyOnError:A=!0,handleError:C=K,onRetry:q=S,onError:g,retryInterval:U=5e3,isBrowser:I=w}=n;let{options:l}=n;const x=s?{next_page_token:s}:{},R=new URLSearchParams(k(k({},i),x)),F=N(o,R);try{l=J(l,I),globalThis!=null&&globalThis.AccessToken&&(l.headers=await M(l==null?void 0:l.headers,globalThis.AccessToken,I));const u=await d(F,l),f=await u.json(),{status:h,statusText:P}=u;if(!u.ok)if(g&&z(g))g({status:h,statusText:P,body:f});else throw{statusCode:u.status,statusText:u.statusText,response:u,message:(T=f==null?void 0:f.message)!=null?T:u.statusText};return f}catch(u){if(A){if(C(u),t&&c>0)return new Promise(f=>{const h=c-1;q(h),setTimeout(()=>{f(G(o,n,h))},U)})}else throw u}},J=(o,n=w)=>{const c=k({credentials:"include"},o);return c.headers=Q(o==null?void 0:o.headers,n),c},M=async(o,n,c=w)=>{if(o||(o={}),!c)return o;try{const i=await n();i&&(o.Authorization=`Bearer ${i}`)}catch(i){console.error(i)}return o},Q=(o,n=w)=>{if(o||(o={}),!n)return o;const c="_csrf=",i="X-CSRF-TOKEN";try{let s=document.cookie.split(";").find(t=>t.includes(c));s&&!o[i]&&(s=s.trim().slice(c.length),o[i]=s)}catch(d){console.error(d)}return o},V=(o,n)=>o.replace("%namespace%",n),Y=o=>{var c;let n="";return((c=globalThis==null?void 0:globalThis.AppConfig)==null?void 0:c.apiUrl)&&o?n=V(globalThis.AppConfig.apiUrl,o):n=W(),n.endsWith("/")&&(n=n.slice(0,-1)),n},Z=(o,n)=>(o.startsWith("/")&&(o=o.slice(1)),`${Y(n)}/api/v1/${o}`),j=o=>Object.keys(o!=null?o:{}).reduce((n,c)=>(n[c]=encodeURIComponent(encodeURIComponent(o[c])),n),{namespace:"",workflowId:"",scheduleId:"",runId:"",queue:""});function sn(o,n,c=!0){c&&(n=j(n));const i={cluster:"/cluster","events.ascending":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/events`,"events.descending":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/events/reverse`,namespaces:"/namespaces",query:`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/query`,"schedule.delete":`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}`,schedule:`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}`,schedules:`/namespaces/${n==null?void 0:n.namespace}/schedules`,"search-attributes":"/search-attributes",settings:"/settings","task-queue":`/namespaces/${n==null?void 0:n.namespace}/task-queues/${n==null?void 0:n.queue}`,user:"/me","workflow.terminate":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}/terminate`,workflow:`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/runs/${n==null?void 0:n.runId}`,"workflows.archived":`/namespaces/${n==null?void 0:n.namespace}/workflows/archived`,workflows:`/namespaces/${n==null?void 0:n.namespace}/workflows`};return Z(i[o],n==null?void 0:n.namespace)}export{sn as a,K as h,un as i,H as n,G as r};
